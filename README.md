# How I Built This:

[Redux Slice Documentation](https://redux-toolkit.js.org/api/createslice)

[Redux Reducers Documentation](https://redux.js.org/tutorials/fundamentals/part-3-state-actions-reducers)

### 6. Create a new file in the src/features/topics directory and name it topicSlice.js

6a. Is named topics.
```javascript
import { createSlice } from "@reduxjs/toolkit";
export const topicsSlice = createSlice({
name: 'topics',
})
```

6b. Has initial state consisting of an object that includes one property, topics, which corresponds to an empty object. This inner topics object will eventually hold all topics keyed by id.
```javascript
import { createSlice } from "@reduxjs/toolkit";
export const topicsSlice = createSlice({
name: 'topics',
initialState: {
  topics: {
  // will eventually hold all topics keyed by id.
  }
}
})
```

6c. Has an addTopic action. You can expect the payload for this action to look like {id: '123456', name: 'name of topic', icon: 'icon url'}. Store these values in the state as a new topic object.
```javascript
import { createSlice } from "@reduxjs/toolkit";
const topicSlice = createSlice({
  name: 'topics',
  initialState: {
    topics: {
      // Will eventually hold all topics keyed by id
    }
  },
  reducers: {
    addTopic: (state, action) => {
      const { id, name, icon } = action.payload;
      // topics keyed by id
      state.topics[id] = {
        id: id,
        name: name,
        icon,
        quizIds: []
      };
    }
  }
})
```

6e. Each topic object added to the state should also have a quizIds property, which will correspond to an array containing the ids of each quiz associated with the topic. 

When a topic is first created, it won’t have any associated quizzes, but you should still create an empty quizIds array so that all topics in the state conform to the same shape.
```javascript
import { createSlice } from "@reduxjs/toolkit";
const topicSlice = createSlice({
name: 'topics',
initialState: {
  topics: {
    // Will eventually hold all topics keyed by id
  }
},
reducers: {
  addTopic: (state, action) => {
    // topics keyed by id
    state.topics[action.payload.id] = {
      id: action.payload.id,
      name: action.payload.name,
      icon: action.payload.icon,
      // quizIds property from 6e
      quizIds: [],
    }
  },
}
})
```

6f. Create a selector that selects the topics object nested within initialState.
```javascript
const selectTopics = (state) => state.topics.topics
```
6e. Export the selector as well as the action creators and reducer that your slice generates.
```javascript
export const topicsSlice = createSlice({
...
})

export const selectTopics = (state) => state.topics.topics;
// action creators export
export const { addTopic } = topicsSlice.action;
// export reducer that our slice generates
export const topicsReducer =  topicsSlice.reducer;
```

### 7. Add topics to the app’s store.
7a. Import the reducer generated by your topics slice in src/app/store.js
```javascript
import { topicsReducer } from "../features/topics/topicsSlice";
```

7b. add it to the empty object passed to configureStore under the key topics.
```javascript
import { configureStore } from "@reduxjs/toolkit";
import {topicsReducer } from "../features/topics/topicsSlice";

export default configureStore({
  reducer: {
    topics: topicsReducer,
  },
});
```

### 8. In src/features/topics/Topics.js,
8a.  import the selector defined in your slice
```javascript
import { selectTopics } from "./topicsSlice";
```

8b. Use it to access all the topics in state
```javascript
import { useSelector } from 'react-redux';
```

8c. Replace the empty object currently assigned to topics with the topics in state.
```javascript
import { selectTopics } from "../features/topics/topicsSlice";
// assigned to topics with topics in state
// need to import useSelector and then call it in conjunction with our selector to access all the topics in state.
const topics = useSelector(selectTopics);

```

### 9. Hook the new topic form up to the action creators our slice generates. 
In src/components/NewTopicForm.js, 

9a. Import addTopic 
Then import addTopic into NewTopicForm.js
```javascript
import { addTopic } from '../features/topics/topicsSlice';
```

9b. Dispatch it from the event handler that runs when the new topic form is submitted.

Hint: You will need to import and call the useDispatch() method in order to dispatch actions to the store.
```javascript
import { useDispatch } from 'react-redux';

export default function NewTopicForm() {
  const dispatch = useDispatch();
  ...
}
```

9c. Include the topic’s name in the action payload as well as an id property (generate a value for this property by calling uuidv4()) and an icon property.
```javascript
  const handleSubmit = (e) => {
    ...
    
    // dispatch your add topic action here
    dispatch(addTopic( {id: uuidv4(), name: name, icon: icon } ));
    history.push(ROUTES.topicsRoute());
  };
```

Checkpoint: Verify that the code is working by filling out the form and submitting it. It should  redirect to the http://localhost:3000/topics page and a newly created topic should be there.

### 10. Build out the necessary functionality to add quizzes to our app. This will involve creating two new slices—one for the quizzes themselves and one for the cards that comprise them—and adding an action to your topics slice to associate quizzes with the topic to which they belong. To start, 

10a. Create in the src/features/quizzes directory, create a new file containing a slice for quizzes that is named "quizzes".

Create a new file in src/features/quizzes called quizzesSlice.js
```javascript
import { createSlice } from "@reduxjs/toolkit";

export const quizzesSlice = createSlice({
  name: 'quizzes',
})
```

10b. Has initial state consisting of an object that includes one property, quizzes, which corresponds to an empty object.
```javascript
import { createSlice } from "@reduxjs/toolkit";

export const quizzesSlice = createSlice({
  name: 'quizzes',
  initialState: {
    // This inner quizzes object will eventually hold all quizzes keyed by id.
    quizzes: {}
  },
})
```

10c. Has an addQuiz action. This action will receive a payload of the form { id: '123', name: 'quiz name', topicId: '456', cardIds: ['1', '2', '3', ...]}.
```javascript
import { createSlice } from "@reduxjs/toolkit";

const quizzesSlice = createSlice({
  name: 'quizzes',
  initialState: {
    // This inner quizzes object will eventually hold all quizzes keyed by id.
    quizzes: {},
  },
  reducers: {
    addQuiz: (state, action) => {
      // Remember, we want the quizzes object to be keyed by quiz id, so insert your newly created quiz object as the value associated with the id you receive in the action’s payload.
      const { id, name, topicId, cardIds } = action.payload;
      state.quizzes[id] = action.payload;
      state.quizzes[name] = action.payload;
      state.quizzes[topicId] = action.payload;
      state.quizzes[cardIds] = action.payload;
    }
  }
})
```

10d. Export the selector as well as the action creators and reducer that your slice generates.

In quizzesSlice.js, at the bottom of the file
```javascript
// Export of selector
export const selectQuizzes = (state) => state.quizzes.quizzes;
// Export of action creator(s)
export const { addQuiz } = quizzesSlice.actions;
// Export of reducer that our slice generates
export const quizzesReducer = quizzesSlice.reducer;

```

11a. Add an action to your topics slice
```javascript
export const topicsSlice = createSlice({
  name: 'topics',
  initialState: {topics: {}},
  reducers: {
    addTopic: (state, action) => {
      ...
    },
    // Arbitrary name chosen because I do not know what purpose this action serves
    anActionToTopicSlice: (state, action) => {
      // Do something...???
    }
  }
})
```

11b. Adds a quiz’s id to the quizIds array
From Hint: push the payload’s quizId into that topic’s quizIds array.
```javascript
export const topicSlice = createSlice({
  name: 'topics',
  initialState: {topics: {}},
  reducers: {
    addTopic: (state, action) => {
      ...
    },
    anActionToTopicSlice: (state, action) => {
      // Through object deconstruction, 
      // topicId = action.payload.topicId
      // quizId = action.payload.quizId      
      const { topicId, quizId } = action.payload;

      // From Hint: push the payload’s quizId into that topic’s quizIds array.
      quizIds.push(quizId)
    }
  }
})
```

11c. From Hint: Use the payload’s topicId to find the correct topic in state.

Add a quiz's id to the quizIds array (of the topic with which the newly quiz is associated). 

```javascript
export const topicSlice = createSlice({
  name: 'topics',
  initialState: {topics: {}},
  reducers: {
    addTopic: (state, action) => {
      ...
    },
    anActionToTopicSlice: (state, action) => {
      // Through object deconstruction, 
      // topicId = action.payload.topicId
      // quizId = action.payload.quizId      
      const { topicId, quizId } = action.payload;

      // Use the payload’s topicId to find the correct topic in state.
      state.topics[topicId]

      // From Hint: push the payload’s quizId into that topic’s quizIds array.
      quizIds.push(quizId)
      
    }
  }
})
```

11d. This action action will receive a payload of the form {quizId: '123', topicId: '456'}. 

Hint: Use the payload’s topicId to find the correct topic in state, and push the payload’s quizId into that topic’s quizIds array.

My Hint: Look at the initialState
```javascript
  topics: {
    // Will eventually hold all topics keyed by id
  }
```

```javascript
export const topicSlice = createSlice({
  name: 'topics',
  initialState: {topics: {}},
  reducers: {
    addTopic: (state, action) => {
      ...
    },
    anActionToTopicSlice: (state, action) => {
      // Through object deconstruction, 
      // topicId = action.payload.topicId
      // quizId = action.payload.quizId      
      const { topicId, quizId } = action.payload;

      // Use the payload’s topicId to find the correct topic in state, and push the payload’s quizId into that topic’s quizIds array.
      state.topics[topicId].quizIds.push(quizId)
      
    }
  }
})
```

11f. Rename anActionToTopicSlice to appropriate action creator name (addQuizIdToTopic).
```javascript
export const topicSlice = createSlice({
  name: 'topics',
  initialState: {topics: {}},
  reducers: {
    addTopic: (state, action) => {
      ...
    },
    addQuizIdToTopic: (state, action) => {
      // Through object deconstruction, 
      // topicId = action.payload.topicId
      // quizId = action.payload.quizId      
      const { topicId, quizId } = action.payload;

      // Use the payload’s topicId to find the correct topic in state, and push the payload’s quizId into that topic’s quizIds array.
      state.topics[topicId]quizIds.push(quizId)
      
    }
  }
})
```

11e. Make sure to export this action creator for use elsewhere in the app.
```javascript
export const { addTopic, addQuizIdToTopic } = topicsSlice.actions;
```

### 12. Conceptually, the actions of creating a new quiz and associating it with its topic are a part of a single process. 

12a. Back in the quiz slice file, write an action creator that returns a thunk that dispatches these two actions one after the other.

Remember, thunks take the form:
```javascript
export const newQuizAssociatingItsTopicThunk = (payload) => {
    return (dispatch) => {
      // dispatch multiple actions here
    };
};
```

In quizzesSlice.js, after the quizzesSlice function, create a new function, and export it as follows:
```javascript
export const newQuizAssociatingItsTopicThunk = (payload) => {
    return (dispatch) => {
      // dispatch multiple actions here
      // This action creator will receive a payload of the form
      dispatch(addQuiz(payload));
      dispatch(someAction());
    };
};
```

This new thunk action creator is the one that you will dispatch when a user creates a new quiz.
```javascript
{
  name: 'name of quiz',
  topicId: '123',
  cardIds: ['4', '5', '6'],
  id: '789',
}
```
So the new thunk action creator is as follows: 
```javascript
export const createNewQuizThunk = (payload) => {
  return (dispatch) => {
    // dispatch multiple actions here
    dispatch(addQuiz(payload));
    dispatch(addQuizIdToTopic( {topicId: payload.topicId, id: payload.id} ));
  };
};
```

### 13. To test your work, you’ll need to connect your action creator to src/components/NewQuizForm and make that component work.

13a. First, import your topics selector from your topics slice and replace assign a call to that selector to the variable topics (which is currently assigned an empty object).

Hint: To use your selector you will need to call useSelector with the selector you defined in your topics slice.

```javascript
import { useSelector } from 'react-redux';
import { selectTopics } from '../features/topics/topicsSlice';
```

13b. Inside NewQuizForm function, 
```javascript
const topics = useSelector(selectTopics);
```

14a. Import the thunk action creator from your quiz slice
```javascript
import { newQuizAssociatingItsTopicThunk } from '../features/quizzes/quizzesSlice';
```

14b. Dispatch it (the thunk action creator from quizzesSlice) from the handleSubmit() event handler that fires when the new quiz form is submitted. Remember, that action creator expects to receive a payload of the form { id: '123', name: 'quiz name', topicId: '456', cardIds: ['1', '2', '3', ...]}.
```javascript
import {useDispatch} from 'react-redux';

export default function NewQuizForm() {
  // ...
  const dispatch = useDispatch();

  const handleSubmit = (e) => {
    ...
    const cardIds = [];

    dispatch(
      newQuizAssociatingItsTopicThunk({
        name: name,
        topicId: topicId,
        // For now, pass the empty cardIds array variable for the cardIds property (you’ll change that in a later task).
        cardIds: cardIds,
        id: quizId,
      })
    )
  }

}
```
14c. You’ll have to generate an id by calling uuidv4. 

```javascript
  const handleSubmit = (e) => {
    e.preventDefault();
    if (name.length === 0) {
      return;
    }

    const cardIds = [];

    // You’ll have to generate an id by calling uuidv4.
    // NOTE: You'll have to place the quizId variable above our dispatch call, or else it won't work properly
    let quizId = uuidv4();

    dispatch(
      newQuizAssociatingItsTopicThunk({
        name: name,
        topicId: topicId,
        cardIds: cardIds,
        id: quizId,
    }))

    // create the new cards here and add each card's id to cardIds
    // create the new quiz here

    history.push(ROUTES.quizzesRoute());
  };
```

14d. Checkpoint: Test that your action creator works by filling out the new quiz form. After your quiz is created you should be rerouted to the /quizzes page and should see your newly created quiz there.
```javascript
// ERROR MESSAGE:
// TypeError: Cannot read property 'quizIds' of undefined
```

15a Lastly, import your selector in src/features/quizzes/Quizzes.js and src/features/quizzes/Quiz.js and make sure those components are displaying the correct data:
```javascript
// In Quizzes.js
import { useSelector } from 'react-redux';
import { selectQuizzes } from './quizzesSlice';

export default function Quizzes() {
  const quizzes = useSelector(selectQuizzes);
  ...
}

// In Quiz.js
import { useSelector } from 'react-redux';
import { selectQuizzes } from "./quizzesSlice";
export default function Quiz() {
  const quizzes = useSelector(selectQuizzes);
  ...
}
```


### 16a in the src/features/cards directory, create a new file containing slice for cards that:

Is named 'cards'

Has initial state consisting of an object that includes one property, cards, which corresponds to an empty object. This inner cards object will eventually hold all cards keyed by id.

Has an addCard action. This action will receive a payload of the form { id: '123', front: 'front of card', back: 'back of card'}.





```javascript

```

```javascript

```

```javascript

```

```javascript

```















# To Run

# State

The app's state is totally normalized, with slices for topics, quizzes, and cards.

# Routes

- `/new-topic` – form to create a new topic
- `/topics` – index of all topics
- `/topics/:topicId` – page for an individual topic
- `/new-quiz` – form to create a new quiz
- `/quizzes` – index of all quizzes
- `/quizzes/:quizId` – page for an individual quiz

# To Test

1. Create topics
2. Create quizzes
3. Visit the page for an individual quiz and flip the cards over

# Questions

Is this appropriately scoped? Does it have too many features? Too few?
